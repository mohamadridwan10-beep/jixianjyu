<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é›†è´¤æ™ºèƒ½æŸ¥å¯ v5.1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { 
            touch-action: manipulation; 
            -webkit-tap-highlight-color: transparent; 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
            background-color: #f8fafc;
        }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(0,0,0,0.05); }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(76px, 1fr)); gap: 0.75rem; }
        [x-cloak] { display: none !important; }
        
        .status-btn { transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); }
        .status-btn:active { transform: scale(0.92); }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden text-slate-800" x-data="attendanceApp()" x-init="initApp()">

    <header class="glass z-50 shrink-0 shadow-sm">
        <div class="px-4 pt-4 pb-3">
            <div class="flex justify-between items-center mb-4">
                <div>
                    <h1 class="text-2xl font-bold tracking-tight text-slate-900" x-text="currentTime">00:00</h1>
                    <p class="text-xs font-semibold text-slate-400 uppercase tracking-wider" x-text="currentDate">DATE</p>
                </div>
                
                <div class="bg-slate-100 p-1 rounded-lg flex text-xs font-bold shadow-inner">
                    <button @click="switchMode('weekday')" 
                        class="px-3 py-1.5 rounded-md transition-all duration-300"
                        :class="mode === 'weekday' ? 'bg-white text-indigo-600 shadow-sm' : 'text-slate-400'">
                        ğŸ“… å·¥ä½œæ—¥
                    </button>
                    <button @click="switchMode('weekend')" 
                        class="px-3 py-1.5 rounded-md transition-all duration-300"
                        :class="mode === 'weekend' ? 'bg-white text-emerald-600 shadow-sm' : 'text-slate-400'">
                        ğŸ–ï¸ å‘¨æœ«
                    </button>
                </div>
            </div>

            <div class="flex justify-between items-center">
                <div class="flex gap-2 text-xs font-bold">
                    <template x-if="mode === 'weekday'">
                        <div class="flex gap-2">
                            <span class="px-2 py-1 rounded bg-green-100 text-green-700">å·²åˆ° <span x-text="stats.arrived"></span></span>
                            <span class="px-2 py-1 rounded bg-red-100 text-red-700" x-show="stats.missing > 0">æœªçŸ¥ <span x-text="stats.missing"></span></span>
                        </div>
                    </template>
                    <template x-if="mode === 'weekend'">
                        <div class="flex gap-2">
                            <span class="px-2 py-1 rounded bg-green-100 text-green-700">ç•™å®¿ <span x-text="stats.staying"></span></span>
                            <span class="px-2 py-1 rounded bg-blue-100 text-blue-700">å›å®¶ <span x-text="stats.home"></span></span>
                        </div>
                    </template>
                    <span class="px-2 py-1 rounded bg-orange-100 text-orange-700" x-show="stats.late > 0">æ™šå½’ <span x-text="stats.late"></span></span>
                </div>

                <div class="flex gap-2">
                    <button @click="showHistory = true" class="text-slate-400 text-xs font-medium hover:text-slate-600">å†å²</button>
                    <button @click="resetAll()" class="flex items-center gap-1 bg-slate-800 text-white px-3 py-1.5 rounded-full text-xs font-bold shadow-lg active:scale-95 transition">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                        é‡ç½®
                    </button>
                </div>
            </div>
        </div>

        <div class="flex border-t border-slate-100">
            <button @click="activeTab = 'female'" 
                class="flex-1 py-3 text-sm font-bold transition-colors relative"
                :class="activeTab === 'female' ? 'text-pink-600 bg-pink-50/30' : 'text-slate-400'">
                ğŸ‘© 3æ¥¼å¥³ç”Ÿ
                <div x-show="activeTab === 'female'" class="absolute bottom-0 left-0 w-full h-0.5 bg-pink-500"></div>
            </button>
            <button @click="activeTab = 'male'" 
                class="flex-1 py-3 text-sm font-bold transition-colors relative"
                :class="activeTab === 'male' ? 'text-indigo-600 bg-indigo-50/30' : 'text-slate-400'">
                ğŸ‘¨ 5æ¥¼ç”·ç”Ÿ
                <div x-show="activeTab === 'male'" class="absolute bottom-0 left-0 w-full h-0.5 bg-indigo-500"></div>
            </button>
        </div>
    </header>

    <main class="flex-1 overflow-y-auto p-3 space-y-4 pb-32 bg-slate-50">
        <div class="text-center py-2" x-show="mode === 'weekend'">
            <span class="text-[10px] bg-blue-50 text-blue-500 px-3 py-1 rounded-full border border-blue-100">
                ğŸ’¡ å‘¨æœ«æ¨¡å¼ï¼šç‚¹å‡»åˆ‡æ¢ ç•™å®¿/å›å®¶
            </span>
        </div>
        <div class="text-center py-2" x-show="mode === 'weekday'">
            <span class="text-[10px] bg-indigo-50 text-indigo-500 px-3 py-1 rounded-full border border-indigo-100">
                ğŸ’¡ å·¥ä½œæ—¥æ¨¡å¼ï¼šç‚¹å‡»åˆ‡æ¢ å·²åˆ°/å¼‚å¸¸
            </span>
        </div>

        <template x-for="room in activeList" :key="room.id">
            <div class="bg-white rounded-2xl p-4 shadow-[0_2px_8px_rgba(0,0,0,0.04)] border border-slate-100">
                <div class="flex justify-between items-center mb-3">
                    <div class="flex items-center gap-2">
                        <span class="text-xl font-bold text-slate-700 tracking-tight" x-text="room.id"></span>
                        <span class="bg-slate-100 text-slate-400 text-[10px] px-1.5 py-0.5 rounded-md font-bold" x-text="room.students.length"></span>
                    </div>
                    <div class="flex gap-1">
                        <button @click="clearRoom(room.id)" class="p-1.5 text-slate-300 hover:text-red-400 transition"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button>
                        <template x-if="mode === 'weekend'">
                            <div class="flex gap-1">
                                <button @click="batchSet(room.id, 'home')" class="px-2 py-1 rounded-lg bg-blue-50 text-blue-600 text-[10px] font-bold">å…¨å›å®¶</button>
                                <button @click="batchSet(room.id, 'staying')" class="px-2 py-1 rounded-lg bg-green-50 text-green-600 text-[10px] font-bold">å…¨ç•™å®¿</button>
                            </div>
                        </template>
                        <template x-if="mode === 'weekday'">
                            <button @click="batchSet(room.id, 'arrived')" class="px-2 py-1 rounded-lg bg-indigo-50 text-indigo-600 text-[10px] font-bold">âœ… ä¸€é”®å·²åˆ°</button>
                        </template>
                    </div>
                </div>
                
                <div class="card-grid">
                    <template x-for="student in room.students" :key="student.name">
                        <button 
                            @click="toggleStatus(room.id, student.name)"
                            class="status-btn relative aspect-[1/0.9] rounded-xl flex flex-col items-center justify-center p-1 border-2"
                            :class="getStatusStyle(student.status)"
                        >
                            <span class="text-[13px] font-bold truncate w-full text-center tracking-wide" x-text="formatName(student.name)"></span>
                            <span class="text-[9px] mt-1 font-bold opacity-90 scale-90" x-text="getStatusLabel(student.status)"></span>
                            <div x-show="['late','missing'].includes(student.status)" class="absolute top-1 right-1 w-2 h-2 rounded-full bg-current animate-ping opacity-75"></div>
                        </button>
                    </template>
                </div>
            </div>
        </template>
    </main>

    <div class="fixed bottom-0 left-0 right-0 p-4 bg-white/90 backdrop-blur-md border-t border-slate-200 z-40 flex gap-3 shadow-[0_-10px_40px_rgba(0,0,0,0.05)]">
        <button @click="copyReport('leader')" class="flex-1 bg-slate-800 text-white py-3.5 rounded-xl font-bold shadow-lg active:scale-95 transition flex flex-col items-center justify-center">
            <span class="text-sm">ğŸ“‹ é¢†å¯¼/è€å¸ˆæ±‡æŠ¥</span>
            <span class="text-[10px] text-slate-400 font-normal">ç»Ÿè®¡æ•°æ® + å¼‚å¸¸åå•</span>
        </button>
        <button @click="copyReport('parent')" class="flex-1 bg-emerald-600 text-white py-3.5 rounded-xl font-bold shadow-lg shadow-emerald-200 active:scale-95 transition flex flex-col items-center justify-center">
            <span class="text-sm">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶é•¿ç¾¤å…¬ç¤º</span>
            <span class="text-[10px] text-emerald-100 font-normal">ä»…æ˜¾ç¤ºåœ¨æ ¡åå•</span>
        </button>
    </div>

    <div x-show="showHistory" x-cloak class="fixed inset-0 z-[60] bg-slate-900/40 backdrop-blur-sm" @click.self="showHistory = false">
        <div class="absolute right-0 top-0 bottom-0 w-full max-w-sm bg-white shadow-2xl flex flex-col" x-transition:enter="transition transform duration-300" x-transition:enter-start="translate-x-full" x-transition:enter-end="translate-x-0">
            <div class="p-5 border-b bg-slate-50 flex justify-between items-center">
                <h2 class="font-bold text-lg text-slate-800">æŸ¥å¯æ¡£æ¡ˆ</h2>
                <button @click="showHistory = false" class="text-slate-400 hover:text-slate-600 text-2xl">&times;</button>
            </div>
            <div class="flex-1 overflow-y-auto p-4 space-y-3 bg-slate-50/50">
                <template x-for="(rec, idx) in history" :key="idx">
                    <div class="bg-white p-3 rounded-xl border border-slate-100 shadow-sm">
                        <div class="flex justify-between text-xs text-slate-400 mb-2">
                            <span x-text="rec.date + ' ' + rec.time"></span>
                            <span class="font-bold" :class="rec.mode==='weekday'?'text-indigo-500':'text-emerald-500'" x-text="rec.mode==='weekday'?'å·¥ä½œæ—¥':'å‘¨æœ«'"></span>
                        </div>
                        <div class="text-xs text-slate-700 whitespace-pre-wrap leading-relaxed font-mono bg-slate-50 p-2 rounded" x-text="rec.text"></div>
                    </div>
                </template>
            </div>
            <div class="p-4 border-t bg-white">
                <button @click="archive()" class="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold shadow-lg shadow-indigo-200">ğŸ’¾ ä¿å­˜å½“å‰è®°å½•</button>
            </div>
        </div>
    </div>

    <script>
        function attendanceApp() {
            return {
                mode: 'weekday',
                activeTab: 'female',
                showHistory: false,
                currentTime: '', currentDate: '',
                history: [],
                statusData: {},
                
                dormData: {
                    female: [
                        { id: '301', students: ['è”¡æ™“å‡¤2','é»„èŠ·é¢2'] },
                        { id: '302', students: ['æ´ªé¢–ç¥¯1','ç‹æ¶µ1','é™ˆæ¬£ç²1','é˜®å½©å²š1','éƒ­å†°è‰³1'] },
                        { id: '304', students: ['æ½˜å©§è¹1','å´æ™¨å¾®1','è©¹åœ£å¨œ1','é™ˆå®æ™¶1','åº„äº¦è²1','é»„å†°é“ƒ1'] },
                        { id: '307', students: ['æçŠ2','ç‹æ€ç’2'] },
                        { id: '309', students: ['éƒ‘é¦¨æ½¼2','ç‹ç´çº¹2','é™ˆè¯—é’°2','åˆ˜èŠ³å†°2','ç‹é™æ€¡2','æ—ç»å½¤2'] },
                        { id: '310', students: ['å‚…å®é™1','ææ€æ¸”1','æ—èŒ¹é¢–1','åˆ˜ç‡•æ•1'] },
                        { id: '311', students: ['èµ–æœ¨é¦™1','å¼ æ·‘ä¸½2','å¼ çªæ¶µ2','æˆ´çƒ¨1','é™ˆé™æ€¡'] },
                        { id: '313', students: ['é»„ç‡•å¦‚1','åº·ç‘œè±1','ä¸˜èˆ’ç´1','è‚–ç‡•çº¢1','ä½™ç¿1','æ—é’°å©·1'] },
                        { id: '314', students: ['é™ˆå§æ¶µ2','æ›¾å¦‚è2','é™ˆè¯—çª2','é»„å©‰å©·2','åˆ˜è¯—å©·2'] },
                        { id: '316', students: ['è®¸æ€æ±2','ç‹æ¢¦çª2','è‹é“ƒè‰³2','æ—æ™ºç²2','æ¨å†¬è²2','ç‹ç´«é‘«2'] },
                        { id: '318', students: ['æ—ç¾å¿ƒ1','åˆ˜æ€¡å©·1','å‘¨çš–ä¹1','ç‹æ™“è‰º1'] },
                        { id: '320', students: ['ç« æ©çª2','æ›¾é›ªå‡Œ2','åº„å®‰å¦®1','å€ªå«æ›¦2'] }
                    ],
                    male: [
                        { id: '508', students: ['ç‹è´è¶Š1','é™ˆå‡¯æ˜1','æ›¾æ¯…1','æ—å…¸æ³½1','å´æ¡å®‡1','å´ç‚«æ°1','å¼ ä¿Šæ°1'] },
                        { id: '510', students: ['è”¡é€¸é¸¿1','é»„æ—­æ–Œ1','é‚¹æ™ºæ·¼1','é™ˆä¹¦å‹‡1','èŒƒæ˜ŒèŒ‚1','åº„æ±Ÿæ£®2','æ—é’°æ’1'] },
                        { id: '512', students: ['é™ˆä¿Šå…´1','è®¸ç…œè±ª1','é™ˆæµ·æ—1','å´æ°¸æ°1','é¢œå¤©æ—­2','çŸ³èˆª2'] },
                        { id: '514', students: ['åˆ˜ä¿Šè±ª2','é™ˆå­æ¡¢2','é™ˆæ¶›2','å‘¨æ˜±æ­2','æ¨è¯‘é¹2','æ±Ÿåˆ©å½¬2'] },
                        { id: '516', students: ['é­å‡Œäº‘1','å¢ç’Ÿè€€1','é™ˆæ³“ç¿1','å°¤éº’æº2','é’Ÿèˆ’èˆª2','æ´ªæ€é‘«2'] }
                    ]
                },

                // âœ… ä¿®å¤ç‚¹ï¼šæ‰¾å›äº†ä¸¢å¤±çš„ activeList å‡½æ•°
                get activeList() {
                    return this.dormData[this.activeTab].map(room => ({
                        id: room.id,
                        students: room.students.map(name => ({
                            name: name,
                            status: this.statusData[this.getKey(room.id, name)] || 'unknown'
                        }))
                    }));
                },

                initApp() {
                    this.updateTime(); setInterval(() => this.updateTime(), 1000);
                    const saved = localStorage.getItem('v5_status');
                    if(saved) this.statusData = JSON.parse(saved);
                    const savedHist = localStorage.getItem('v5_history');
                    if(savedHist) this.history = JSON.parse(savedHist);
                    const savedMode = localStorage.getItem('v5_mode');
                    if(savedMode) this.mode = savedMode;

                    this.$watch('statusData', v => localStorage.setItem('v5_status', JSON.stringify(v)));
                    this.$watch('mode', v => localStorage.setItem('v5_mode', v));
                    this.$watch('history', v => localStorage.setItem('v5_history', JSON.stringify(v)));
                },

                updateTime() {
                    const now = new Date();
                    this.currentTime = now.toLocaleTimeString('en-GB', {hour:'2-digit', minute:'2-digit'});
                    this.currentDate = now.toLocaleDateString('zh-CN', {month:'short', day:'numeric', weekday:'short'});
                },

                switchMode(m) { this.mode = m; },

                getKey(roomId, name) { return `${this.mode}_${roomId}_${name}`; },

                toggleStatus(roomId, name) {
                    const key = this.getKey(roomId, name);
                    const curr = this.statusData[key] || 'unknown';
                    let next = 'unknown';

                    if (this.mode === 'weekday') {
                        // å·¥ä½œæ—¥: æœªçŸ¥ -> å·²åˆ° -> æ™šå½’å¾…ç¡®è®¤ -> æœªçŸ¥å»å‘ -> è¯·å‡
                        const map = {
                            'unknown': 'arrived', 'arrived': 'late', 'late': 'missing', 'missing': 'leave', 'leave': 'unknown'
                        };
                        next = map[curr];
                    } else {
                        // å‘¨æœ«: æœªçŸ¥ -> ç•™å®¿ -> å›å®¶ -> æ™šå½’å¾…ç¡®è®¤ -> æœªçŸ¥å»å‘
                        const map = {
                            'unknown': 'staying', 'staying': 'home', 'home': 'late', 'late': 'missing', 'missing': 'leave', 'leave': 'unknown'
                        };
                        next = map[curr];
                    }
                    this.statusData[key] = next;
                },

                batchSet(roomId, status) {
                    const room = this.dormData[this.activeTab].find(r => r.id === roomId);
                    if(room) room.students.forEach(n => this.statusData[this.getKey(roomId, n)] = status);
                },

                clearRoom(roomId) {
                    const room = this.dormData[this.activeTab].find(r => r.id === roomId);
                    if(room) room.students.forEach(n => delete this.statusData[this.getKey(roomId, n)]);
                },

                resetAll() {
                    if(confirm(`âš ï¸ ç¡®å®šè¦é‡ç½®ã€${this.mode === 'weekday' ? 'å·¥ä½œæ—¥' : 'å‘¨æœ«'}ã€‘çš„æ‰€æœ‰çŠ¶æ€å—ï¼Ÿ`)) {
                        Object.keys(this.statusData).forEach(k => {
                            if(k.startsWith(this.mode)) delete this.statusData[k];
                        });
                        this.statusData = JSON.parse(JSON.stringify(this.statusData)); 
                    }
                },

                getStatusStyle(s) {
                    if (!s || s === 'unknown') return 'bg-slate-50 border-slate-200 text-slate-300';
                    const styles = {
                        'arrived': 'bg-indigo-50 border-indigo-500 text-indigo-700 shadow-sm ring-1 ring-indigo-100',
                        'staying': 'bg-emerald-50 border-emerald-500 text-emerald-700 shadow-sm ring-1 ring-emerald-100',
                        'home': 'bg-blue-50 border-blue-400 text-blue-600',
                        'late': 'bg-orange-50 border-orange-500 text-orange-700 shadow-md',
                        'missing': 'bg-red-50 border-red-500 text-red-700 shadow-md font-bold',
                        'leave': 'bg-amber-50 border-amber-400 text-amber-700',
                    };
                    return styles[s] || styles['unknown'];
                },

                getStatusLabel(s) {
                    const labels = {
                        'unknown': 'ç‚¹å‡»',
                        'arrived': 'å·²åˆ°',
                        'staying': 'ç•™å®¿',
                        'home': 'å›å®¶',
                        'late': 'å¾…ç¡®è®¤',
                        'missing': 'æœªçŸ¥å»å‘',
                        'leave': 'è¯·å‡'
                    };
                    return labels[s] || 'ç‚¹å‡»';
                },

                formatName(n) { return n.replace(/[0-9]/g, ''); },

                get allStudents() {
                    let all = [];
                    ['female', 'male'].forEach(t => this.dormData[t].forEach(r => r.students.forEach(n => {
                        all.push({ id: r.id, name: this.formatName(n), status: this.statusData[this.getKey(r.id, n)] || 'unknown' });
                    })));
                    return all;
                },
                
                get stats() {
                    const list = this.allStudents;
                    return {
                        arrived: list.filter(s => s.status === 'arrived').length,
                        staying: list.filter(s => s.status === 'staying').length,
                        home: list.filter(s => s.status === 'home').length,
                        late: list.filter(s => s.status === 'late').length,
                        missing: list.filter(s => s.status === 'missing').length
                    };
                },

                copyReport(target) {
                    const s = this.stats;
                    const dateStr = `${new Date().getMonth()+1}æœˆ${new Date().getDate()}æ—¥`;
                    let text = '';

                    if (target === 'leader') {
                        text = `ã€${this.mode==='weekday'?'å¹³æ—¥':'å‘¨æœ«'}æŸ¥å¯æ±‡æŠ¥ã€‘${dateStr}\n------------------\n`;
                        if (this.mode === 'weekday') {
                            text += `âœ… å·²åˆ°: ${s.arrived}äºº\n`;
                        } else {
                            text += `ğŸ›ï¸ ç•™å®¿: ${s.staying} | ğŸ  å›å®¶: ${s.home}\n`;
                        }
                        
                        const lates = this.allStudents.filter(i => i.status === 'late');
                        const missings = this.allStudents.filter(i => i.status === 'missing');
                        
                        if (lates.length) text += `\nâš ï¸ æ™šå½’å¾…ç¡®è®¤ (${lates.length}äºº):\n${lates.map(i=>i.id+i.name).join('ã€')}\n`;
                        if (missings.length) text += `\nâŒ æœªçŸ¥å»å‘ (${missings.length}äºº):\n${missings.map(i=>i.id+i.name).join('ã€')}\n`;
                        
                        if (!lates.length && !missings.length) text += `\nâœ¨ å¸¸è§„çŠ¶æ€å…¨å‘˜æ­£å¸¸ã€‚`;
                    } else {
                        text = `ã€é›†è´¤æ•™è‚²ã€‘${dateStr} ${this.mode==='weekday'?'æ™šç‚¹å':'ç•™å®¿åå•'}\n------------------\n`;
                        text += `ä»¥ä¸‹åŒå­¦ç›®å‰${this.mode==='weekday'?'å·²å›å¯å®¤':'åœ¨æ ¡ç•™å®¿'}ï¼š\n\n`;
                        
                        let hasData = false;
                        ['female', 'male'].forEach(t => {
                            let groupName = t==='female'?'ğŸ‘© å¥³ç”Ÿå®¿èˆ':'ğŸ‘¨ ç”·ç”Ÿå®¿èˆ';
                            let lines = [];
                            this.dormData[t].forEach(r => {
                                const validStatus = this.mode === 'weekday' ? ['arrived'] : ['staying'];
                                const list = r.students.filter(n => validStatus.includes(this.statusData[this.getKey(r.id, n)]));
                                if(list.length) lines.push(`[${r.id}] ${list.map(n=>this.formatName(n)).join('ã€')}`);
                            });
                            if(lines.length) {
                                text += `${groupName}:\n${lines.join('\n')}\n\n`;
                                hasData = true;
                            }
                        });
                        if(!hasData) text += "(æš‚æ— è®°å½•)\n";
                        text += `æ³¨ï¼š${this.mode==='weekday'?'æœªåˆ—å‡ºè€…ä¸ºè¯·å‡æˆ–å¼‚å¸¸':'æœªåˆ—å‡ºè€…ä¸ºå›å®¶æˆ–è¯·å‡'}`;
                    }
                    
                    navigator.clipboard.writeText(text).then(()=>alert('å†…å®¹å·²å¤åˆ¶')).catch(()=>alert('å¤åˆ¶å¤±è´¥'));
                },

                archive() {
                    const r = this.stats;
                    const report = this.mode==='weekday' 
                        ? `å·²åˆ°:${r.arrived} æ™šå½’:${r.late} æœªçŸ¥:${r.missing}`
                        : `ç•™å®¿:${r.staying} å›å®¶:${r.home} å¼‚å¸¸:${r.missing+r.late}`;
                    
                    this.history.unshift({
                        date: this.currentDate, time: this.currentTime, mode: this.mode, text: report
                    });
                    alert('å·²ä¿å­˜åˆ°å†å²è®°å½•');
                }
            }
        }
    </script>
</body>
</html>